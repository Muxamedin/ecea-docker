# choose system
# ---------------------------------------------------
FROM ubuntu:16.04
# ---------------------------------------------------

# ---------------------------------------------------
# options
# ---------------------------------------------------
ARG build_vesrion
# ---------------------------------------------------

# ---------------------------------------------------
# environment section
# ---------------------------------------------------
ENV BUILD_VERSION=${build_vesrion}
# ---------------------------------------------------

# ---------------------------------------------------
# install section
# ---------------------------------------------------
COPY  opt  /opt
RUN chmod +x /opt/ecloud/install && \
/opt/ecloud/install && \
 rm  -f /opt/ecloud/install
# --------------------------------------------------- 

# ---------------------------------------------------
# expose section
# --------------------------------------------------- 
# cm agent port
EXPOSE 8030
# cm agent secure port
EXPOSE 8031
#db
EXPOSE 3306
# http port
EXPOSE 80
# erunner port
EXPOSE 2411
 
# ---------------------------------------------------
# supervisor script
# ---------------------------------------------------
CMD ["/opt/ecloud/supervisor"]
# ---------------------------------------------------